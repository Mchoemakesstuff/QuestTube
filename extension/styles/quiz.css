/* QuestTube - Quiz Styles
   Question cards, options, feedback, battle scene, dialog box layout */

/* ============ QUESTION CARD ============ */
.ytq-question {
  background: var(--bg-panel);
  border: 4px double var(--border);
  padding: 24px;
  margin-bottom: 16px;
  box-shadow: 0 6px 0 rgba(0, 0, 0, 0.4);
  position: relative;
  min-height: 200px;
  overflow: hidden;
}


/* Animations */
@keyframes slide-in-right {
  0% {
    opacity: 0;
    transform: translateY(-40px) scale(0.97);
  }

  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.slide-in-right {
  animation: slide-in-right 0.35s cubic-bezier(0.22, 1, 0.36, 1);
}

/* ============ BATTLE SCENE ============ */
.ytq-combatant {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 20;
}

.damage-text {
  position: absolute;
  color: #ef4444;
  font-family: 'Press Start 2P', monospace;
  font-size: 10px;
  pointer-events: none;
  animation: floatUpFade 1s forwards;
  text-shadow: 1px 1px 0 #000;
  z-index: 10;
}

@keyframes floatUpFade {
  0% {
    transform: translateY(0);
    opacity: 1;
  }

  100% {
    transform: translateY(-30px);
    opacity: 0;
  }
}

@keyframes shake-damage {
  0% {
    transform: translate(0, 0);
  }

  25% {
    transform: translate(-2px, 2px);
  }

  50% {
    transform: translate(2px, -2px);
  }

  75% {
    transform: translate(-2px, -2px);
  }

  100% {
    transform: translate(0, 0);
  }
}

.damaged {
  animation: shake-damage 0.3s cubic-bezier(.36, .07, .19, .97) both;
  filter: brightness(2) sepia(1) hue-rotate(-50deg) saturate(5);
}


@keyframes shake-hard {
  0%,
  100% {
    transform: translateX(0);
  }

  20% {
    transform: translateX(-6px) rotate(-2deg);
  }

  40% {
    transform: translateX(6px) rotate(2deg);
  }

  60% {
    transform: translateX(-6px);
  }

  80% {
    transform: translateX(6px);
  }
}

.shake-hard {
  animation: shake-hard 0.4s cubic-bezier(.36, .07, .19, .97) both;
}

/* Combo Badge */
.ytq-combo-badge {
  position: absolute;
  top: -16px;
  right: -8px;
  background: linear-gradient(180deg, var(--gold) 0%, #b45309 100%);
  color: var(--bg-dark);
  padding: 8px 12px;
  border: 2px solid #fff;
  border-radius: 8px;
  transform: rotate(10deg);
  z-index: 100;
  box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;
  align-items: center;
  line-height: 1;
}

.ytq-combo-count {
  font-family: var(--pixel-font);
  font-weight: bold;
  font-size: 16px;
  text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.4);
}

.ytq-combo-label {
  font-family: var(--pixel-font);
  font-size: 8px;
  margin-top: 4px;
  letter-spacing: 1px;
}

.ytq-combo-text {
  color: var(--gold);
  font-weight: bold;
  text-shadow: 1px 1px 0 #000;
  animation: pulse 0.5s infinite;
  display: inline-block;
  margin-top: 4px;
  font-size: 10px;
}

.ytq-question-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 2px dashed var(--border);
}

.ytq-question-number {
  font-family: var(--pixel-font);
  font-size: 8px;
  color: var(--gold);
  text-transform: uppercase;
}

.ytq-question-type {
  font-family: var(--pixel-font);
  font-size: 7px;
  padding: 4px 8px;
  background: var(--bg-dark);
  border: 1px solid var(--border);
  color: var(--text-dim);
}

.ytq-question-type.free_recall {
  background: #1a3a2a;
  border-color: #2a5a3a;
  color: var(--green);
}

.ytq-question-type.multiple_choice {
  background: #3a2a1a;
  border-color: #5a3a2a;
  color: var(--gold);
}

.ytq-question-type.short_answer {
  background: #1e1a30;
  border-color: #302a4a;
  color: #a78bfa;
}

.ytq-question-text {
  font-family: var(--pixel-font);
  font-size: 10px;
  color: var(--text);
  line-height: 1.8;
  margin-bottom: 16px;
}

/* ============ MCQ OPTIONS ============ */
.ytq-options {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.ytq-option {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  background: var(--bg-dark);
  border: 2px solid var(--border);
  border-bottom: 4px solid var(--border-dark);
  cursor: pointer;
  transition: transform 0.08s, background 0.1s, border-color 0.1s, box-shadow 0.1s, opacity 0.2s, filter 0.2s;
  box-shadow:
    inset -2px -2px 0 var(--border-dark),
    inset 2px 2px 0 var(--border-light);
  animation: option-pop-in 0.3s ease-out both;
}

.ytq-option:nth-child(1) { animation-delay: 0.05s; }
.ytq-option:nth-child(2) { animation-delay: 0.13s; }
.ytq-option:nth-child(3) { animation-delay: 0.21s; }
.ytq-option:nth-child(4) { animation-delay: 0.29s; }

@keyframes option-pop-in {
  0% { opacity: 0; transform: translateY(12px) scale(0.95); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}

.ytq-option:hover {
  transform: translateY(-2px);
  border-bottom-width: 6px;
  background: #1c1b28;
  box-shadow:
    inset -2px -2px 0 var(--border-dark),
    inset 2px 2px 0 var(--border-light),
    0 0 12px rgba(167, 139, 250, 0.12);
}

.ytq-option:active {
  transform: translateY(2px);
  border-bottom-width: 2px;
}

.ytq-option.selected {
  background: #1a3a2a;
  border-color: var(--green);
  box-shadow:
    inset -2px -2px 0 #16a34a,
    inset 2px 2px 0 #86efac,
    0 0 10px rgba(74, 222, 128, 0.3);
}

.ytq-option-label {
  width: 28px;
  height: 28px;
  background: var(--bg-panel);
  border: 2px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--pixel-font);
  font-size: 10px;
  color: var(--text-dim);
  margin-right: 12px;
}

.ytq-option.selected .ytq-option-label {
  background: var(--green);
  border-color: var(--green-dark);
  color: var(--bg-dark);
}

.ytq-option-text {
  font-family: var(--pixel-font);
  font-size: 9px;
  color: var(--text);
  line-height: 1.6;
  flex: 1;
}

/* ============ TEXT INPUT ============ */
.ytq-textarea {
  width: 100%;
  min-height: 100px;
  background: var(--bg-dark);
  border: 2px solid var(--border);
  padding: 12px;
  color: var(--text);
  font-family: var(--pixel-font);
  font-size: 10px;
  resize: vertical;
  box-sizing: border-box;
  box-shadow:
    inset 2px 2px 0 var(--border-dark);
}

.ytq-textarea:focus {
  outline: none;
  border-color: var(--green);
  box-shadow:
    inset 2px 2px 0 var(--border-dark),
    0 0 10px rgba(74, 222, 128, 0.2);
}

.ytq-textarea::placeholder {
  color: var(--text-dim);
}

/* ============ SUBMIT BUTTON ============ */
.ytq-submit {
  width: 100%;
  padding: 16px;
  background: linear-gradient(180deg, var(--green) 0%, var(--green-dark) 100%);
  border: 3px solid #16a34a;
  font-family: var(--pixel-font);
  font-size: 12px;
  color: var(--bg-dark);
  cursor: pointer;
  transition: all 0.1s;
  margin-top: 16px;
  text-transform: uppercase;
  box-shadow:
    inset -3px -3px 0 #15803d,
    inset 3px 3px 0 #86efac,
    4px 4px 0 rgba(0, 0, 0, 0.4);
}

.ytq-submit:hover:not(:disabled) {
  transform: translateY(-3px);
  box-shadow:
    inset -3px -3px 0 #15803d,
    inset 3px 3px 0 #86efac,
    6px 6px 0 rgba(0, 0, 0, 0.4);
}

.ytq-submit:active:not(:disabled) {
  transform: translateY(2px);
  box-shadow:
    inset -3px -3px 0 #15803d,
    inset 3px 3px 0 #86efac,
    2px 2px 0 rgba(0, 0, 0, 0.4);
}

.ytq-submit:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  filter: grayscale(50%);
}

/* ============ OLD FEEDBACK (legacy) ============ */
.ytq-feedback-section {
  margin-bottom: 20px;
}

.ytq-feedback-title {
  font-size: 8px;
  color: var(--gold);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 12px;
}

.ytq-feedback-item {
  background: var(--bg-panel);
  border: 2px solid var(--border);
  padding: 16px;
  margin-bottom: 8px;
  border-left: 4px solid var(--border);
}

.ytq-feedback-item.correct {
  border-left-color: var(--green);
}

.ytq-feedback-item.incorrect {
  border-left-color: var(--red);
}

.ytq-feedback-question {
  font-size: 9px;
  color: var(--text);
  margin-bottom: 8px;
}

.ytq-feedback-answer {
  font-size: 8px;
  color: var(--text-dim);
  line-height: 1.6;
}

.ytq-feedback-correct {
  color: var(--green);
}

.ytq-feedback-incorrect {
  color: var(--red);
}

/* =========================================
   Feedback Bar (Duolingo-style slim bar)
   ========================================= */
.ytq-fb-bar {
  display: none;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-top: 14px;
  padding: 10px 14px;
  border: 2px solid var(--border);
  border-radius: 6px;
  animation: fb-bar-in 0.25s ease-out;
}

.ytq-fb-bar.visible {
  display: flex;
}

.ytq-fb-bar.correct {
  border-color: var(--green);
  background: rgba(22, 163, 74, 0.12);
}

.ytq-fb-bar.incorrect {
  border-color: var(--red);
  background: rgba(239, 68, 68, 0.12);
}

@keyframes fb-bar-in {
  0%   { opacity: 0; transform: translateY(8px); }
  70%  { opacity: 1; transform: translateY(-2px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* Question exit animation — fall deeper */
@keyframes fall-down {
  0%   { opacity: 1; transform: translateY(0) scale(1); }
  100% { opacity: 0; transform: translateY(80px) scale(0.95); }
}

.fall-down {
  animation: fall-down 0.3s cubic-bezier(0.55, 0, 1, 0.45) forwards;
}

/* Legacy slide-out kept for compatibility */
@keyframes slide-out-left {
  0%   { opacity: 1; transform: translateX(0) scale(1); }
  100% { opacity: 0; transform: translateX(-60px) scale(0.97); }
}

.slide-out-left {
  animation: slide-out-left 0.22s cubic-bezier(0.55, 0, 1, 0.45) forwards;
}

/* ============ DUNGEON DROP TRANSITION ============ */
.ytq-dungeon-drop {
  position: fixed;
  inset: 0;
  z-index: 100000;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: auto;
}

/* Black gate that slams down */
.ytq-drop-gate {
  position: absolute;
  inset: 0;
  background: #000;
  animation: gate-slam 0.4s cubic-bezier(0.22, 0, 0.36, 1) forwards;
}

@keyframes gate-slam {
  0%   { clip-path: inset(0 0 100% 0); }
  85%  { clip-path: inset(0 0 -5% 0); }
  100% { clip-path: inset(0 0 0 0); }
}

/* Floor text */
.ytq-drop-text {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  opacity: 0;
  transform: scale(0.8);
}

.ytq-dungeon-drop.show-text .ytq-drop-text {
  opacity: 1;
  transform: scale(1);
  transition: opacity 0.2s, transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
}

.ytq-drop-floor {
  font-family: var(--pixel-font);
  font-size: 28px;
  color: #fbbf24;
  letter-spacing: 6px;
  text-shadow: 0 0 20px rgba(251, 191, 36, 0.6), 2px 2px 0 rgba(0, 0, 0, 0.8);
}

.ytq-drop-name {
  font-family: var(--pixel-font);
  font-size: 11px;
  color: #807a6e;
  letter-spacing: 3px;
  text-transform: uppercase;
  padding: 4px 16px;
  position: relative;
}

/* Zone-themed drop name banners */
.ytq-dungeon-drop.zone-meadow .ytq-drop-name {
  color: #86efac;
  background: linear-gradient(90deg, transparent, rgba(74, 222, 128, 0.08), transparent);
  text-shadow: 0 0 8px rgba(74, 222, 128, 0.3);
}
.ytq-dungeon-drop.zone-cave .ytq-drop-name {
  color: #d4a020;
  background: linear-gradient(90deg, transparent, rgba(251, 191, 36, 0.08), transparent);
  text-shadow: 0 0 8px rgba(251, 191, 36, 0.3);
}
.ytq-dungeon-drop.zone-dungeon .ytq-drop-name {
  color: #c4b5fd;
  background: linear-gradient(90deg, transparent, rgba(167, 139, 250, 0.08), transparent);
  text-shadow: 0 0 10px rgba(167, 139, 250, 0.4);
}
.ytq-dungeon-drop.zone-abyss .ytq-drop-name {
  color: #fca5a5;
  background: linear-gradient(90deg, transparent, rgba(239, 68, 68, 0.1), transparent);
  text-shadow: 0 0 10px rgba(239, 68, 68, 0.4);
}

/* Loading status — appears after floor text */
.ytq-drop-status {
  font-family: var(--pixel-font);
  font-size: 8px;
  color: #464658;
  letter-spacing: 2px;
  margin-top: 20px;
  opacity: 0;
  transition: opacity 0.3s;
  animation: status-pulse 2s ease-in-out infinite;
}

.ytq-dungeon-drop.show-status .ytq-drop-status {
  opacity: 1;
}

/* ---- Pixel-art loading dots (inline after "Descending") ---- */
.ytq-drop-loader {
  display: inline-flex;
  gap: 3px;
  margin-left: 2px;
  vertical-align: middle;
}

.ytq-loader-block {
  width: 4px;
  height: 4px;
  background: #464658;
  image-rendering: pixelated;
  animation: loader-fill 1.5s steps(1) infinite;
}

.ytq-loader-block:nth-child(1) { animation-delay: 0s; }
.ytq-loader-block:nth-child(2) { animation-delay: 0.4s; }
.ytq-loader-block:nth-child(3) { animation-delay: 0.8s; }

@keyframes loader-fill {
  0%, 100% { background: #464658; box-shadow: none; }
  20%      { background: #fbbf24; box-shadow: 0 0 6px rgba(251, 191, 36, 0.5); }
  40%      { background: #d4a020; box-shadow: 0 0 4px rgba(212, 160, 32, 0.3); }
  60%      { background: #8b6914; box-shadow: none; }
}

/* Zone-tinted loader blocks */
.zone-meadow .ytq-loader-block {
  animation-name: loader-fill-meadow;
}
@keyframes loader-fill-meadow {
  0%, 100% { background: #464658; box-shadow: none; }
  20%      { background: #4ade80; box-shadow: 0 0 6px rgba(74, 222, 128, 0.5); }
  40%      { background: #22c55e; box-shadow: 0 0 4px rgba(34, 197, 94, 0.3); }
  60%      { background: #166534; box-shadow: none; }
}

.zone-cave .ytq-loader-block {
  animation-name: loader-fill;
}

.zone-dungeon .ytq-loader-block {
  animation-name: loader-fill-dungeon;
}
@keyframes loader-fill-dungeon {
  0%, 100% { background: #464658; box-shadow: none; }
  20%      { background: #a78bfa; box-shadow: 0 0 6px rgba(167, 139, 250, 0.5); }
  40%      { background: #7c3aed; box-shadow: 0 0 4px rgba(124, 58, 237, 0.3); }
  60%      { background: #4c1d95; box-shadow: none; }
}

.zone-abyss .ytq-loader-block {
  animation-name: loader-fill-abyss;
}
@keyframes loader-fill-abyss {
  0%, 100% { background: #464658; box-shadow: none; }
  20%      { background: #ef4444; box-shadow: 0 0 6px rgba(239, 68, 68, 0.5); }
  40%      { background: #dc2626; box-shadow: 0 0 4px rgba(220, 38, 38, 0.3); }
  60%      { background: #7f1d1d; box-shadow: none; }
}

@keyframes status-pulse {
  0%, 100% { opacity: 0.4; }
  50%      { opacity: 1; }
}

/* Reveal — gate rises from bottom, text fades */
.ytq-dungeon-drop.reveal .ytq-drop-text {
  opacity: 0;
  transition: opacity 0.15s;
}

.ytq-dungeon-drop.reveal .ytq-drop-gate {
  animation: gate-rise 0.5s cubic-bezier(0.55, 0, 1, 0.45) forwards;
}

@keyframes gate-rise {
  0%   { clip-path: inset(0 0 0 0); }
  100% { clip-path: inset(0 0 100% 0); }
}

/* ============ ZONE-THEMED DUNGEON DROP ============ */

.ytq-dungeon-drop.zone-meadow .ytq-drop-gate {
  background: linear-gradient(180deg, #000 0%, #0a1a0a 100%);
}
.ytq-dungeon-drop.zone-meadow .ytq-drop-floor {
  color: #4ade80;
  text-shadow: 0 0 20px rgba(74, 222, 128, 0.6), 2px 2px 0 rgba(0,0,0,0.8);
}

.ytq-dungeon-drop.zone-cave .ytq-drop-gate {
  background: linear-gradient(180deg, #000 0%, #1a1810 100%);
}
.ytq-dungeon-drop.zone-cave .ytq-drop-floor {
  color: #fbbf24;
  text-shadow: 0 0 20px rgba(251, 191, 36, 0.6), 2px 2px 0 rgba(0,0,0,0.8);
}

.ytq-dungeon-drop.zone-dungeon .ytq-drop-gate {
  background: linear-gradient(180deg, #000 0%, #0e0a1a 100%);
}
.ytq-dungeon-drop.zone-dungeon .ytq-drop-floor {
  color: #a78bfa;
  text-shadow: 0 0 20px rgba(167, 139, 250, 0.6), 2px 2px 0 rgba(0,0,0,0.8);
}

.ytq-dungeon-drop.zone-abyss .ytq-drop-gate {
  background: linear-gradient(180deg, #000 0%, #1a0808 100%);
}
.ytq-dungeon-drop.zone-abyss .ytq-drop-floor {
  color: #ef4444;
  text-shadow: 0 0 20px rgba(239, 68, 68, 0.6), 2px 2px 0 rgba(0,0,0,0.8);
}

/* ============ DUNGEON RISE TRANSITION (ascending) ============ */
.ytq-dungeon-rise {
  position: fixed;
  inset: 0;
  z-index: 100000;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: auto;
}

/* Gate that closes upward from bottom */
.ytq-rise-gate {
  position: absolute;
  inset: 0;
  background: #000;
  animation: gate-close-up 0.4s cubic-bezier(0.22, 0, 0.36, 1) forwards;
}

@keyframes gate-close-up {
  0%   { clip-path: inset(100% 0 0 0); }
  85%  { clip-path: inset(-5% 0 0 0); }
  100% { clip-path: inset(0 0 0 0); }
}

/* Rise text */
.ytq-rise-text {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  opacity: 0;
  transform: scale(0.8);
}

.ytq-dungeon-rise.show-text .ytq-rise-text {
  opacity: 1;
  transform: scale(1);
  transition: opacity 0.2s, transform 0.2s cubic-bezier(0.22, 1, 0.36, 1);
}

.ytq-rise-title {
  font-family: var(--pixel-font);
  font-size: 28px;
  color: #fbbf24;
  letter-spacing: 6px;
  text-shadow: 0 0 20px rgba(251, 191, 36, 0.6), 2px 2px 0 rgba(0, 0, 0, 0.8);
}

.ytq-rise-subtitle {
  font-family: var(--pixel-font);
  font-size: 11px;
  color: #807a6e;
  letter-spacing: 3px;
  text-transform: uppercase;
}

.ytq-rise-status {
  font-family: var(--pixel-font);
  font-size: 8px;
  color: #464658;
  letter-spacing: 2px;
  margin-top: 20px;
  opacity: 0;
  transition: opacity 0.3s;
  animation: status-pulse 2s ease-in-out infinite;
}

.ytq-dungeon-rise.show-status .ytq-rise-status {
  opacity: 1;
}

/* Reveal — gate drops downward, text fades */
.ytq-dungeon-rise.reveal .ytq-rise-text {
  opacity: 0;
  transition: opacity 0.15s;
}

.ytq-dungeon-rise.reveal .ytq-rise-gate {
  animation: gate-drop-down 0.5s cubic-bezier(0.55, 0, 1, 0.45) forwards;
}

@keyframes gate-drop-down {
  0%   { clip-path: inset(0 0 0 0); }
  100% { clip-path: inset(100% 0 0 0); }
}

/* Prevent overflow during transitions */
#ytq-question-container {
  overflow: hidden;
}

.ytq-fb-left {
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 0;
}

.ytq-fb-icon {
  flex-shrink: 0;
  font-size: 16px;
  line-height: 1;
}

.ytq-fb-coin {
  width: 20px;
  height: 20px;
  image-rendering: pixelated;
  object-fit: contain;
  vertical-align: middle;
}

.ytq-fb-text {
  font-family: 'Silkscreen', var(--pixel-font);
  font-size: 12px;
  color: var(--text);
  line-height: 1.3;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.ytq-fb-bar.correct .ytq-fb-text {
  color: var(--green);
}

.ytq-fb-bar.incorrect .ytq-fb-text {
  color: #fca5a5;
}

.ytq-fb-text strong {
  color: var(--green);
}

@keyframes shake {
  10%, 90% { transform: translate3d(-1px, 0, 0); }
  20%, 80% { transform: translate3d(2px, 0, 0); }
  30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
  40%, 60% { transform: translate3d(4px, 0, 0); }
}

/* ---- Floating +1 Coin Reward ---- */
.ytq-float-reward {
  display: flex;
  align-items: center;
  gap: 4px;
  font-family: var(--pixel-font);
  font-size: 14px;
  color: #fcd34d;
  text-shadow: 1px 1px 0 #000, 0 0 8px rgba(252, 211, 77, 0.4);
  pointer-events: none;
  transform: translateX(-50%);
  animation: float-up 1s ease-out forwards;
}

.ytq-float-coin {
  width: 22px;
  height: 22px;
  image-rendering: pixelated;
  object-fit: contain;
}

@keyframes float-up {
  0%   { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
  60%  { opacity: 1; transform: translateX(-50%) translateY(-50px) scale(1.15); }
  100% { opacity: 0; transform: translateX(-50%) translateY(-80px) scale(0.9); }
}

/* ---- Check / Next Buttons ---- */
.ytq-check-btn,
.ytq-next-btn {
  display: inline-block;
  padding: 8px 16px;
  border: 2px solid var(--border);
  font-family: var(--pixel-font);
  font-size: 10px;
  cursor: pointer;
  transition: all 0.1s;
  text-transform: uppercase;
  margin-top: 8px;
}

.ytq-check-btn {
  background: var(--bg-dark);
  color: var(--text);
  box-shadow: inset -2px -2px 0 var(--border-dark);
}

.ytq-check-btn:hover {
  background: var(--bg-panel);
  transform: translateY(-2px);
}

.ytq-next-btn {
  flex-shrink: 0;
  margin-top: 0;
  padding: 8px 18px;
  background: var(--gold);
  color: var(--bg-dark);
  border-color: #b45309;
  box-shadow: inset -2px -2px 0 #b45309;
}

.ytq-next-btn:hover {
  transform: translateY(-2px);
  filter: brightness(1.1);
}

.ytq-correct-text {
  color: var(--green);
  font-weight: bold;
}

/* Option States */
.ytq-option.correct {
  background: rgba(74, 222, 128, 0.15);
  border-color: #4ade80;
  border-bottom-color: #22c55e;
  box-shadow:
    inset -2px -2px 0 rgba(34, 197, 94, 0.2),
    inset 2px 2px 0 rgba(134, 239, 172, 0.2);
  transform: scale(1.02);
  animation: none;
}

.ytq-option.correct .ytq-option-label {
  background: #22c55e;
  border-color: #16a34a;
  color: #fff;
}

.ytq-option.incorrect {
  background: rgba(239, 68, 68, 0.12);
  border-color: #ef4444;
  border-bottom-color: #dc2626;
  opacity: 0.75;
  animation: none;
}

.ytq-option.incorrect .ytq-option-label {
  background: #ef4444;
  border-color: #dc2626;
  color: #fff;
}

.ytq-option.dimmed {
  opacity: 0.35;
  filter: grayscale(0.8);
  animation: none;
}

/* =========================================
   Battle Mode
   ========================================= */
.ytq-battle-scene {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  height: 260px;
  margin-bottom: -20px;
  padding: 0 20px;
  position: relative;
  z-index: 10;
  background-size: cover;
  background-position: center bottom;
  background-repeat: no-repeat;
  border-radius: 8px 8px 0 0;
  border: 3px solid var(--border);
  border-bottom: none;
  box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.5);
}

.ytq-hero,
.ytq-enemy {
  width: 240px;
  height: 240px;
  object-fit: contain;
  image-rendering: pixelated;
  filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.5));
  position: relative;
  transition: transform 0.2s, filter 0.2s;
  margin-bottom: 30px;
}

.ytq-hero {
  transform-origin: center bottom;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center bottom;
}

.ytq-enemy {
  transform-origin: center bottom;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center bottom;
  bottom: 10px;
}

/* Battle Animations */
@keyframes hero-attack {
  0% {
    transform: translateX(0);
  }

  50% {
    transform: translateX(120px);
  }

  100% {
    transform: translateX(0);
  }
}

@keyframes enemy-attack {
  0% {
    transform: translateX(0);
  }

  50% {
    transform: translateX(-120px);
  }

  100% {
    transform: translateX(0);
  }
}

@keyframes damage-blink {
  0% {
    filter: brightness(1) sepia(0) hue-rotate(0deg);
    opacity: 1;
  }

  10% {
    filter: brightness(2) sepia(1) hue-rotate(-50deg) saturate(5);
    opacity: 0.8;
  }

  20% {
    filter: brightness(1) sepia(0) hue-rotate(0deg);
    opacity: 1;
  }

  30% {
    filter: brightness(2) sepia(1) hue-rotate(-50deg) saturate(5);
    opacity: 0.8;
  }

  40% {
    filter: brightness(1) sepia(0) hue-rotate(0deg);
    opacity: 1;
  }
}

.ytq-hero.attacking {
  animation: hero-attack 0.4s ease-in-out;
}

.ytq-enemy.attacking {
  animation: enemy-attack 0.4s ease-in-out;
}

.ytq-hero.damaged,
.ytq-enemy.damaged {
  animation: damage-blink 0.5s ease-in-out;
  animation-fill-mode: forwards;
}

/* ============ DYNAMIC ACTIONS ============ */
@keyframes shake-screen {
  0% {
    transform: translate(0, 0);
  }

  25% {
    transform: translate(-5px, 5px);
  }

  50% {
    transform: translate(5px, -5px);
  }

  75% {
    transform: translate(-5px, -5px);
  }

  100% {
    transform: translate(0, 0);
  }
}

.shake-screen {
  animation: shake-screen 0.4s cubic-bezier(.36, .07, .19, .97) both;
}

@keyframes pulse-red {
  0% {
    filter: drop-shadow(0 0 2px rgba(239, 68, 68, 0.7));
  }

  50% {
    filter: drop-shadow(0 0 8px rgba(239, 68, 68, 1));
  }

  100% {
    filter: drop-shadow(0 0 2px rgba(239, 68, 68, 0.7));
  }
}

.damage-number {
  position: absolute;
  color: #ef4444;
  font-family: 'Press Start 2P', monospace;
  font-size: 14px;
  pointer-events: none;
  z-index: 100;
  text-shadow: 2px 2px 0 #000;
  animation: float-damage 1s forwards;
  left: 50%;
  top: -20px;
  transform: translateX(-50%);
}

@keyframes float-damage {
  0% {
    transform: translate(-50%, 0) scale(1);
    opacity: 1;
  }

  50% {
    transform: translate(-50%, -30px) scale(1.5);
    opacity: 1;
  }

  100% {
    transform: translate(-50%, -60px) scale(1);
    opacity: 0;
  }
}

/* =========================================
   Game HUD Bar
   ========================================= */
.ytq-hud {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 20px;
  border-bottom: var(--panel-stroke);
  background: rgba(12, 12, 20, 0.7);
  overflow: visible;
}

.ytq-hud-left {
  display: flex;
  align-items: center;
  gap: 14px;
  flex: 1 1 0;
  min-width: 0;
}

.ytq-hud-center {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 0 0 auto;
}

.ytq-hud-right {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 6px;
  flex: 1 1 0;
  min-width: 0;
}

/* =========================================
   Progress Hearts — CSS pixel art
   8×7 grid, each "pixel" = 3×3 CSS px
   Dimensions: 24px × 21px
   Grid:
     . X X . . X X .
     X X X X X X X X
     X X X X X X X X
     X X X X X X X X
     . X X X X X X .
     . . X X X X . .
     . . . X X . . .
   ========================================= */
.ytq-hrt-row {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: center;
}

.ytq-hrt {
  display: inline-block;
  width: 24px;
  height: 21px;
  position: relative;
  image-rendering: pixelated;
  transition: transform 0.25s, filter 0.25s;
}

/* ---- Empty / unanswered heart (dark outline) ---- */
.ytq-hrt-px {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 3px;
  height: 3px;
  background: transparent;
  box-shadow:
    /* Row 0 */
     3px  0 0 #2e2e3e,   6px  0 0 #3a3a4a,
    15px  0 0 #2e2e3e,  18px  0 0 #3a3a4a,
    /* Row 1 */
     0    3px 0 #2e2e3e,  3px  3px 0 #1e1d2a,  6px  3px 0 #1e1d2a,  9px  3px 0 #1e1d2a,
    12px  3px 0 #1e1d2a, 15px  3px 0 #1e1d2a, 18px  3px 0 #1e1d2a, 21px  3px 0 #252434,
    /* Row 2 */
     0    6px 0 #252434,  3px  6px 0 #1a1a26,  6px  6px 0 #1a1a26,  9px  6px 0 #1a1a26,
    12px  6px 0 #1a1a26, 15px  6px 0 #1a1a26, 18px  6px 0 #1a1a26, 21px  6px 0 #1a1a26,
    /* Row 3 */
     0    9px 0 #1e1d2a,  3px  9px 0 #1a1a26,  6px  9px 0 #1a1a26,  9px  9px 0 #1a1a26,
    12px  9px 0 #1a1a26, 15px  9px 0 #1a1a26, 18px  9px 0 #1a1a26, 21px  9px 0 #1e1d2a,
    /* Row 4 */
     3px 12px 0 #1a1a26,  6px 12px 0 #1a1a26,  9px 12px 0 #1a1a26,
    12px 12px 0 #1a1a26, 15px 12px 0 #1a1a26, 18px 12px 0 #1a1a26,
    /* Row 5 */
     6px 15px 0 #1a1a26,  9px 15px 0 #1a1a26,
    12px 15px 0 #1a1a26, 15px 15px 0 #1a1a26,
    /* Row 6 */
     9px 18px 0 #1a1a26, 12px 18px 0 #1a1a26;
  transition: box-shadow 0.3s;
}

/* ---- Filled / correct heart (bright red with shading) ---- */
.ytq-hrt.filled .ytq-hrt-px {
  box-shadow:
    /* Row 0 — tops of the two bumps, highlight */
     3px  0 0 #ff6666,   6px  0 0 #ff8888,
    15px  0 0 #ff6666,  18px  0 0 #ff7777,
    /* Row 1 */
     0    3px 0 #e04040,  3px  3px 0 #ff7777,  6px  3px 0 #ffaaaa,  9px  3px 0 #ff6666,
    12px  3px 0 #ff5555, 15px  3px 0 #ff7777, 18px  3px 0 #ff6666, 21px  3px 0 #cc3030,
    /* Row 2 */
     0    6px 0 #d03535,  3px  6px 0 #ff6666,  6px  6px 0 #ff8888,  9px  6px 0 #ff5555,
    12px  6px 0 #e04040, 15px  6px 0 #ff5555, 18px  6px 0 #e04040, 21px  6px 0 #b82828,
    /* Row 3 */
     0    9px 0 #cc3030,  3px  9px 0 #ff5555,  6px  9px 0 #ff6666,  9px  9px 0 #e04040,
    12px  9px 0 #d03535, 15px  9px 0 #e04040, 18px  9px 0 #cc3030, 21px  9px 0 #a02020,
    /* Row 4 */
     3px 12px 0 #d03535,  6px 12px 0 #e04040,  9px 12px 0 #d03535,
    12px 12px 0 #cc3030, 15px 12px 0 #b82828, 18px 12px 0 #a02020,
    /* Row 5 */
     6px 15px 0 #cc3030,  9px 15px 0 #b82828,
    12px 15px 0 #a02020, 15px 15px 0 #901818,
    /* Row 6 — bottom point */
     9px 18px 0 #a02020, 12px 18px 0 #881515;
}

/* ---- Broken heart (split down middle, cracked, dark red) ---- */
.ytq-hrt.broken .ytq-hrt-px {
  box-shadow:
    /* Row 0 — tops of bumps */
     3px  0 0 #cc4444,   6px  0 0 #dd5555,
    15px  0 0 #cc4444,  18px  0 0 #dd5555,
    /* Row 1 — gap at 9px (the crack) */
     0    3px 0 #aa3030,  3px  3px 0 #dd5555,  6px  3px 0 #ee7070,
    /* crack gap: skip 9px */
    12px  3px 0 #cc4444, 15px  3px 0 #dd5555, 18px  3px 0 #cc4444, 21px  3px 0 #882020,
    /* Row 2 */
     0    6px 0 #882020,  3px  6px 0 #cc4444,  6px  6px 0 #dd5555,
    /* crack shifts right */
    12px  6px 0 #aa3030, 15px  6px 0 #cc4444, 18px  6px 0 #aa3030, 21px  6px 0 #661818,
    /* Row 3 */
     0    9px 0 #882020,  3px  9px 0 #aa3030,  6px  9px 0 #cc4444,
    /* crack */
    12px  9px 0 #882020, 15px  9px 0 #aa3030, 18px  9px 0 #882020, 21px  9px 0 #661818,
    /* Row 4 — left half drops, right half drops */
     3px 12px 0 #882020,  6px 12px 0 #aa3030,
    /* crack gap at 9-12 */
    15px 12px 0 #882020, 18px 12px 0 #661818,
    /* Row 5 */
     6px 15px 0 #882020,
    /* gap */                            15px 15px 0 #661818,
    /* Row 6 — two separated bottom points */
     6px 18px 0 #661818,
    15px 18px 0 #4a1010;
}

/* ---- Recall heart (red tint, same as filled) ---- */
.ytq-hrt.recall .ytq-hrt-px {
  box-shadow:
    /* Row 0 */
     3px  0 0 #ff6666,   6px  0 0 #ff8888,
    15px  0 0 #ff6666,  18px  0 0 #ff7777,
    /* Row 1 */
     0    3px 0 #e04040,  3px  3px 0 #ff7777,  6px  3px 0 #ffaaaa,  9px  3px 0 #ff6666,
    12px  3px 0 #ff5555, 15px  3px 0 #ff7777, 18px  3px 0 #ff6666, 21px  3px 0 #cc3030,
    /* Row 2 */
     0    6px 0 #d03535,  3px  6px 0 #ff6666,  6px  6px 0 #ff8888,  9px  6px 0 #ff5555,
    12px  6px 0 #e04040, 15px  6px 0 #ff5555, 18px  6px 0 #e04040, 21px  6px 0 #b82828,
    /* Row 3 */
     0    9px 0 #cc3030,  3px  9px 0 #ff5555,  6px  9px 0 #ff6666,  9px  9px 0 #e04040,
    12px  9px 0 #d03535, 15px  9px 0 #e04040, 18px  9px 0 #cc3030, 21px  9px 0 #a02020,
    /* Row 4 */
     3px 12px 0 #d03535,  6px 12px 0 #e04040,  9px 12px 0 #d03535,
    12px 12px 0 #cc3030, 15px 12px 0 #b82828, 18px 12px 0 #a02020,
    /* Row 5 */
     6px 15px 0 #cc3030,  9px 15px 0 #b82828,
    12px 15px 0 #a02020, 15px 15px 0 #901818,
    /* Row 6 */
     9px 18px 0 #a02020, 12px 18px 0 #881515;
}

/* ---- Current question glow ---- */
.ytq-hrt.current {
  filter: drop-shadow(0 0 4px rgba(247, 198, 93, 0.5));
  transform: scale(1.15);
}

/* ---- Animations ---- */
@keyframes hrt-pop {
  0%   { transform: scale(1); }
  40%  { transform: scale(1.45); }
  70%  { transform: scale(0.9); }
  100% { transform: scale(1); }
}

.ytq-hrt.pop {
  animation: hrt-pop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Filled heart pop overrides current glow */
.ytq-hrt.filled.pop {
  filter: drop-shadow(0 0 8px rgba(255, 80, 80, 0.6));
}

.ytq-hrt.broken.pop {
  filter: drop-shadow(0 0 8px rgba(255, 80, 80, 0.5));
  animation: hrt-break-in 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes hrt-break-in {
  0%   { transform: scale(1); }
  20%  { transform: scale(1.3) rotate(-8deg); }
  40%  { transform: scale(0.7) rotate(6deg); }
  60%  { transform: scale(1.15) rotate(-3deg); }
  80%  { transform: scale(0.95) rotate(1deg); }
  100% { transform: scale(1) rotate(0deg); }
}

/* ---- Big feedback heart (center-screen pop) ---- */
.ytq-hrt-big {
  display: block;
  width: 24px;
  height: 21px;
  position: relative;
  transform: scale(4);
  image-rendering: pixelated;
}

.ytq-hrt-big .ytq-hrt-px {
  /* Reuse filled heart colors for the big feedback */
  box-shadow:
     3px  0 0 #ff6666,   6px  0 0 #ff8888,
    15px  0 0 #ff6666,  18px  0 0 #ff7777,
     0    3px 0 #e04040,  3px  3px 0 #ff7777,  6px  3px 0 #ffaaaa,  9px  3px 0 #ff6666,
    12px  3px 0 #ff5555, 15px  3px 0 #ff7777, 18px  3px 0 #ff6666, 21px  3px 0 #cc3030,
     0    6px 0 #d03535,  3px  6px 0 #ff6666,  6px  6px 0 #ff8888,  9px  6px 0 #ff5555,
    12px  6px 0 #e04040, 15px  6px 0 #ff5555, 18px  6px 0 #e04040, 21px  6px 0 #b82828,
     0    9px 0 #cc3030,  3px  9px 0 #ff5555,  6px  9px 0 #ff6666,  9px  9px 0 #e04040,
    12px  9px 0 #d03535, 15px  9px 0 #e04040, 18px  9px 0 #cc3030, 21px  9px 0 #a02020,
     3px 12px 0 #d03535,  6px 12px 0 #e04040,  9px 12px 0 #d03535,
    12px 12px 0 #cc3030, 15px 12px 0 #b82828, 18px 12px 0 #a02020,
     6px 15px 0 #cc3030,  9px 15px 0 #b82828,
    12px 15px 0 #a02020, 15px 15px 0 #901818,
     9px 18px 0 #a02020, 12px 18px 0 #881515;
}

/* Broken pixel art for big feedback (dark red, cracked) */
.ytq-hrt-broken-px {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 3px;
  height: 3px;
  background: transparent;
  box-shadow:
     3px  0 0 #cc4444,   6px  0 0 #dd5555,
    15px  0 0 #cc4444,  18px  0 0 #dd5555,
     0    3px 0 #aa3030,  3px  3px 0 #dd5555,  6px  3px 0 #ee7070,
    12px  3px 0 #cc4444, 15px  3px 0 #dd5555, 18px  3px 0 #cc4444, 21px  3px 0 #882020,
     0    6px 0 #882020,  3px  6px 0 #cc4444,  6px  6px 0 #dd5555,
    12px  6px 0 #aa3030, 15px  6px 0 #cc4444, 18px  6px 0 #aa3030, 21px  6px 0 #661818,
     0    9px 0 #882020,  3px  9px 0 #aa3030,  6px  9px 0 #cc4444,
    12px  9px 0 #882020, 15px  9px 0 #aa3030, 18px  9px 0 #882020, 21px  9px 0 #661818,
     3px 12px 0 #882020,  6px 12px 0 #aa3030,
    15px 12px 0 #882020, 18px 12px 0 #661818,
     6px 15px 0 #882020,                            15px 15px 0 #661818,
     6px 18px 0 #661818,
    15px 18px 0 #4a1010;
}

.ytq-hrt-big .ytq-hrt-broken-px {
  /* same as above, inherited */
}

/* Combo HUD */
.ytq-combo-hud {
  display: flex;
  align-items: baseline;
  gap: 2px;
  padding: 3px 8px;
  background: linear-gradient(180deg, rgba(247, 198, 93, 0.2) 0%, rgba(180, 83, 9, 0.2) 100%);
  border: 2px solid var(--gold);
  border-radius: 4px;
  transition: opacity 0.2s, transform 0.2s;
}

.ytq-combo-hud.hidden {
  display: none;
}

.ytq-combo-num {
  font-family: var(--pixel-font);
  font-size: 14px;
  color: var(--gold);
  text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.6);
  line-height: 1;
}

.ytq-combo-x {
  font-family: var(--pixel-font);
  font-size: 8px;
  color: var(--gold);
  opacity: 0.8;
}

@keyframes combo-pulse {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.15); }
  100% { transform: scale(1); }
}

.ytq-combo-hud.pulse {
  animation: combo-pulse 0.3s ease-out;
}

/* Combo fire glow at 5+ */
.ytq-combo-hud.fire {
  box-shadow: 0 0 12px rgba(247, 198, 93, 0.5), 0 0 24px rgba(245, 158, 11, 0.3);
  border-color: #fbbf24;
  background: linear-gradient(180deg, rgba(251, 191, 36, 0.3) 0%, rgba(245, 158, 11, 0.25) 100%);
  animation: fire-glow 0.8s ease-in-out infinite;
}

@keyframes fire-glow {
  0%, 100% { box-shadow: 0 0 12px rgba(247, 198, 93, 0.5), 0 0 24px rgba(245, 158, 11, 0.3); }
  50%      { box-shadow: 0 0 18px rgba(247, 198, 93, 0.7), 0 0 32px rgba(245, 158, 11, 0.5); }
}

@keyframes combo-break {
  0%   { transform: scale(1); opacity: 1; }
  50%  { transform: scale(1.2) rotate(5deg); opacity: 0.5; }
  100% { transform: scale(0); opacity: 0; }
}

.ytq-combo-hud.breaking {
  animation: combo-break 0.35s ease-in forwards;
}

/* Score HUD */
.ytq-score-hud {
  font-family: var(--pixel-font);
  font-size: 12px;
  color: var(--gold);
  text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.6);
  line-height: 1;
  min-width: 36px;
  text-align: right;
}

.ytq-score-label-hud {
  font-family: var(--pixel-font);
  font-size: 7px;
  color: var(--text-dim);
  opacity: 0.7;
}

@keyframes score-tick {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.25); color: #fff; }
  100% { transform: scale(1); }
}

.ytq-score-hud.ticking {
  animation: score-tick 0.3s ease-out;
}

/* =========================================
   Wall Torches — CSS pixel art
   Flame: 5×5 grid, 2-frame flicker
   Body:  5×7 grid (cup + handle + bracket)
   Each "pixel" = 3×3 CSS px
   ========================================= */
.ytq-torch {
  position: absolute;
  top: 50%;
  transform: translateY(-45%);
  width: 15px;
  height: 36px;
  z-index: 5;
  filter: drop-shadow(0 -3px 6px rgba(255, 160, 40, 0.4))
          drop-shadow(0 -2px 12px rgba(255, 120, 20, 0.15));
  animation: torch-glow 1.5s ease-in-out infinite;
  transition: filter 0.3s, opacity 0.3s;
}

.ytq-torch.left {
  left: 8px;
}

.ytq-torch.right {
  right: 3px;
}

/* Ambient wall light splash */
.ytq-torch::after {
  content: '';
  position: absolute;
  top: -6px;
  left: 50%;
  transform: translateX(-50%);
  width: 44px;
  height: 44px;
  background: radial-gradient(circle, rgba(255, 160, 40, 0.1) 0%, transparent 70%);
  pointer-events: none;
  z-index: -1;
}

@keyframes torch-glow {
  0%, 100% {
    filter: drop-shadow(0 -3px 6px rgba(255, 160, 40, 0.4))
            drop-shadow(0 -2px 12px rgba(255, 120, 20, 0.15));
  }
  50% {
    filter: drop-shadow(0 -3px 8px rgba(255, 160, 40, 0.65))
            drop-shadow(0 -2px 16px rgba(255, 120, 20, 0.3));
  }
}

/* ---- Torch flare on correct answer ---- */
.ytq-torch.flare {
  animation: torch-flare 0.6s ease-out;
}

@keyframes torch-flare {
  0%   {
    filter: drop-shadow(0 -3px 6px rgba(255, 160, 40, 0.4))
            drop-shadow(0 -2px 12px rgba(255, 120, 20, 0.15));
    transform: translateY(-45%) scale(1);
  }
  30%  {
    filter: drop-shadow(0 -6px 18px rgba(255, 200, 60, 1))
            drop-shadow(0 -4px 30px rgba(255, 140, 20, 0.7))
            drop-shadow(0 0 40px rgba(255, 100, 0, 0.4));
    transform: translateY(-45%) scale(1.15);
  }
  100% {
    filter: drop-shadow(0 -3px 6px rgba(255, 160, 40, 0.4))
            drop-shadow(0 -2px 12px rgba(255, 120, 20, 0.15));
    transform: translateY(-45%) scale(1);
  }
}

/* ---- Torch dim on wrong answer ---- */
.ytq-torch.dimmed {
  animation: torch-dim 0.8s ease-out;
}

@keyframes torch-dim {
  0%   {
    filter: drop-shadow(0 -3px 6px rgba(255, 160, 40, 0.4))
            drop-shadow(0 -2px 12px rgba(255, 120, 20, 0.15));
    opacity: 1;
  }
  25%  {
    filter: drop-shadow(0 0 2px rgba(255, 100, 20, 0.1));
    opacity: 0.25;
  }
  50%  {
    filter: drop-shadow(0 0 2px rgba(255, 100, 20, 0.1));
    opacity: 0.2;
  }
  100% {
    filter: drop-shadow(0 -3px 6px rgba(255, 160, 40, 0.4))
            drop-shadow(0 -2px 12px rgba(255, 120, 20, 0.15));
    opacity: 1;
  }
}

/* ---- Flame (animated 2-frame pixel art) ---- */
.ytq-torch-flame {
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  width: 3px;
  height: 3px;
  background: transparent;
  image-rendering: pixelated;
  animation: torch-flicker 0.4s steps(1) infinite;
  box-shadow:
    /* Frame 1 default — tip right */
    9px 0 0 #ffed4a,
    3px 3px 0 #fbbf24, 6px 3px 0 #ffd700, 9px 3px 0 #f59e0b,
    0 6px 0 #ea580c, 3px 6px 0 #fb923c, 6px 6px 0 #fbbf24, 9px 6px 0 #f97316, 12px 6px 0 #dc2626,
    3px 9px 0 #dc2626, 6px 9px 0 #ea580c, 9px 9px 0 #b91c1c,
    6px 12px 0 #991b1b;
}

/* Offset right torch so flames don't flicker in sync */
.ytq-torch.right .ytq-torch-flame {
  animation-delay: -0.2s;
}

@keyframes torch-flicker {
  0%, 100% {
    box-shadow:
      9px 0 0 #ffed4a,
      3px 3px 0 #fbbf24, 6px 3px 0 #ffd700, 9px 3px 0 #f59e0b,
      0 6px 0 #ea580c, 3px 6px 0 #fb923c, 6px 6px 0 #fbbf24, 9px 6px 0 #f97316, 12px 6px 0 #dc2626,
      3px 9px 0 #dc2626, 6px 9px 0 #ea580c, 9px 9px 0 #b91c1c,
      6px 12px 0 #991b1b;
  }
  50% {
    box-shadow:
      3px 0 0 #ffed4a,
      3px 3px 0 #f59e0b, 6px 3px 0 #ffd700, 9px 3px 0 #fbbf24,
      0 6px 0 #dc2626, 3px 6px 0 #f97316, 6px 6px 0 #fbbf24, 9px 6px 0 #fb923c, 12px 6px 0 #ea580c,
      3px 9px 0 #b91c1c, 6px 9px 0 #ea580c, 9px 9px 0 #dc2626,
      6px 12px 0 #991b1b;
  }
}

/* ---- Torch body (static: cup + handle + bracket) ---- */
.ytq-torch-body {
  display: block;
  position: absolute;
  top: 15px;
  left: 0;
  width: 3px;
  height: 3px;
  background: transparent;
  image-rendering: pixelated;
  box-shadow:
    /* Row 0 — cup rim (dark metal) */
    3px 0 0 #555570, 6px 0 0 #464658, 9px 0 0 #3a3a4a,
    /* Row 1 — cup/handle junction */
    6px 3px 0 #3a3a4a,
    /* Row 2 — handle (wood brown) */
    6px 6px 0 #8b6914,
    /* Row 3 — handle (darker) */
    6px 9px 0 #7a5c12,
    /* Row 4 — bracket arm (metal grey) */
    0 12px 0 #555570, 3px 12px 0 #4a4a60, 6px 12px 0 #464658, 9px 12px 0 #3a3a4a, 12px 12px 0 #2e2e3e,
    /* Row 5 — bracket stem */
    6px 15px 0 #2e2e3e,
    /* Row 6 — wall mount (darkest) */
    6px 18px 0 #1e1d2a;
}

/* Legacy dot-pop — removed, replaced by hrt-pop */

/* Floating XP */
.ytq-float-xp {
  position: fixed;
  pointer-events: none;
  font-family: var(--pixel-font);
  font-size: 12px;
  color: var(--green);
  text-shadow: 1px 1px 0 #000, 0 0 8px rgba(120, 217, 123, 0.4);
  transform: translateX(-50%);
  animation: float-up 1s ease-out forwards;
  z-index: 10002;
}

/* =========================================
   Dialog Box Quiz Layout
   ========================================= */

/* Modal container */
.ytq-dlg-modal {
  width: min(94vw, 680px);
}

/* Header: portrait thumbnails + title */
.ytq-dlg-header {
  padding: 14px 20px;
}

.ytq-dlg-header-left {
  display: flex;
  align-items: center;
  gap: 8px;
}

.ytq-dlg-portrait {
  width: 32px;
  height: 32px;
  object-fit: contain;
  image-rendering: pixelated;
  border: 2px solid var(--border);
  background: var(--bg-dark);
  border-radius: 4px;
  box-shadow: inset -1px -1px 0 var(--border-dark), inset 1px 1px 0 var(--border-light);
}

.ytq-dlg-vs {
  font-family: var(--pixel-font);
  font-size: 8px;
  color: var(--red);
  text-shadow: 1px 1px 0 #000;
}

/* Progress bar */
.ytq-dlg-progress {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 20px;
  border-bottom: var(--panel-stroke);
  background: rgba(12, 12, 20, 0.7);
}

/* Legacy pdots — removed, replaced by .ytq-hrt-row */

.ytq-dlg-count {
  font-family: var(--pixel-font);
  font-size: 8px;
  color: var(--text-dim);
  white-space: nowrap;
  margin-left: 12px;
}

/* Smaller text sizes for dialog layout */
.ytq-dlg-modal .ytq-question-text {
  font-size: clamp(18px, 2.2vw, 22px);
  line-height: 1.2;
}

.ytq-dlg-modal .ytq-option-text {
  font-size: 18px;
}

.ytq-dlg-modal .ytq-textarea {
  font-size: 20px;
}

.ytq-dlg-modal .ytq-textarea::placeholder {
  font-size: 18px;
}

.ytq-dlg-modal .ytq-fb-text {
  font-size: 13px;
}

/* Flash effects — subtle border pulse instead of glow */
.ytq-dlg-modal.flash-correct {
  animation: dlg-flash-green 0.35s ease-out;
}

.ytq-dlg-modal.flash-incorrect {
  animation: dlg-flash-red 0.35s ease-out;
}

@keyframes dlg-flash-green {
  0%   { border-color: var(--panel-border); }
  40%  { border-color: var(--green); }
  100% { border-color: var(--panel-border); }
}

@keyframes dlg-flash-red {
  0%   { border-color: var(--panel-border); }
  40%  { border-color: var(--red); }
  100% { border-color: var(--panel-border); }
}

/* Heart feedback popup — big pixel art heart */
.ytq-heart-feedback {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  pointer-events: none;
  z-index: 100;
  image-rendering: pixelated;
  animation: heart-fb-pop 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.ytq-heart-feedback.correct {
  filter: drop-shadow(0 0 16px rgba(255, 80, 80, 0.6))
          drop-shadow(0 0 32px rgba(255, 50, 50, 0.3));
}

.ytq-heart-feedback.incorrect {
  filter: drop-shadow(0 0 16px rgba(255, 80, 80, 0.5))
          drop-shadow(0 0 32px rgba(255, 50, 50, 0.25));
}

@keyframes heart-fb-pop {
  0%   { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 1; }
  25%  { transform: translate(-50%, -50%) scale(1.4) rotate(-5deg); opacity: 1; }
  45%  { transform: translate(-50%, -50%) scale(0.95) rotate(2deg); opacity: 1; }
  60%  { transform: translate(-50%, -50%) scale(1.1) rotate(0deg); opacity: 1; }
  100% { transform: translate(-50%, -65%) scale(0.7) rotate(0deg); opacity: 0; }
}

/* =========================================
   Screen Shake — applied to entire modal
   ========================================= */
@keyframes screen-shake {
  0%   { transform: translate(0, 0) rotate(0deg); }
  10%  { transform: translate(-4px, 2px) rotate(-0.5deg); }
  20%  { transform: translate(6px, -3px) rotate(0.5deg); }
  30%  { transform: translate(-5px, -2px) rotate(-0.3deg); }
  40%  { transform: translate(4px, 3px) rotate(0.4deg); }
  50%  { transform: translate(-2px, -1px) rotate(-0.2deg); }
  60%  { transform: translate(3px, 1px) rotate(0.2deg); }
  70%  { transform: translate(-1px, 2px) rotate(-0.1deg); }
  80%  { transform: translate(1px, -1px) rotate(0.1deg); }
  100% { transform: translate(0, 0) rotate(0deg); }
}

@keyframes screen-shake-heavy {
  0%   { transform: translate(0, 0) rotate(0deg); }
  8%   { transform: translate(-8px, 4px) rotate(-1.2deg); }
  16%  { transform: translate(10px, -6px) rotate(1deg); }
  24%  { transform: translate(-10px, -4px) rotate(-0.8deg); }
  32%  { transform: translate(8px, 6px) rotate(0.8deg); }
  40%  { transform: translate(-6px, -3px) rotate(-0.5deg); }
  50%  { transform: translate(5px, 3px) rotate(0.5deg); }
  60%  { transform: translate(-4px, 2px) rotate(-0.3deg); }
  70%  { transform: translate(3px, -2px) rotate(0.3deg); }
  80%  { transform: translate(-2px, 1px) rotate(-0.1deg); }
  90%  { transform: translate(1px, -1px) rotate(0.1deg); }
  100% { transform: translate(0, 0) rotate(0deg); }
}

.screen-shake {
  animation: screen-shake 0.4s cubic-bezier(.36, .07, .19, .97) both;
}

.screen-shake-heavy {
  animation: screen-shake-heavy 0.55s cubic-bezier(.36, .07, .19, .97) both;
}

/* =========================================
   Red Vignette Flash — wrong answer punch
   ========================================= */
.ytq-vignette {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 100001;
  opacity: 0;
}

.ytq-vignette.flash {
  animation: vignette-flash 0.5s ease-out forwards;
}

@keyframes vignette-flash {
  0%   {
    opacity: 1;
    box-shadow: inset 0 0 100px 40px rgba(239, 68, 68, 0.5);
  }
  30%  {
    opacity: 0.7;
    box-shadow: inset 0 0 80px 30px rgba(239, 68, 68, 0.3);
  }
  100% {
    opacity: 0;
    box-shadow: inset 0 0 60px 20px rgba(239, 68, 68, 0);
  }
}

/* =========================================
   Floating Damage Numbers
   ========================================= */
.ytq-dmg-number {
  position: absolute;
  top: 30%;
  left: 50%;
  transform: translate(calc(-50% + var(--dmg-x, 0px)), 0);
  pointer-events: none;
  z-index: 200;
  font-family: var(--pixel-font);
  font-size: 18px;
  font-weight: bold;
  text-shadow: 2px 2px 0 #000, -1px -1px 0 #000;
  animation: dmg-float 1.2s ease-out forwards;
}

.ytq-dmg-hit {
  color: #4ade80;
}

.ytq-dmg-miss {
  color: #ef4444;
  font-size: 14px;
}

.ytq-dmg-number.dmg-crit {
  font-size: 26px;
  color: #fef08a;
  text-shadow: 2px 2px 0 #000, 0 0 12px rgba(254, 240, 138, 0.6);
}

@keyframes dmg-float {
  0% {
    opacity: 1;
    transform: translate(calc(-50% + var(--dmg-x, 0px)), 0) scale(0.5);
  }
  15% {
    opacity: 1;
    transform: translate(calc(-50% + var(--dmg-x, 0px)), -10px) scale(1.3);
  }
  40% {
    opacity: 1;
    transform: translate(calc(-50% + var(--dmg-x, 0px)), -40px) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(calc(-50% + var(--dmg-x, 0px)), -80px) scale(0.8);
  }
}

/* =========================================
   Combo Announcement Text
   ========================================= */
.ytq-combo-announce {
  position: absolute;
  top: 40%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  pointer-events: none;
  z-index: 200;
  font-family: var(--pixel-font);
  font-size: 16px;
  color: #fbbf24;
  letter-spacing: 3px;
  text-transform: uppercase;
  text-shadow:
    2px 2px 0 #000,
    0 0 20px rgba(251, 191, 36, 0.5);
  white-space: nowrap;
  animation: combo-announce 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.ytq-combo-announce.combo-broken {
  color: #ef4444;
  text-shadow:
    2px 2px 0 #000,
    0 0 20px rgba(239, 68, 68, 0.5);
}

.ytq-combo-announce.combo-godlike {
  font-size: 20px;
  color: #fef08a;
  text-shadow:
    2px 2px 0 #000,
    0 0 30px rgba(254, 240, 138, 0.7),
    0 0 60px rgba(251, 191, 36, 0.4);
}

@keyframes combo-announce {
  0%   { transform: translate(-50%, -50%) scale(0) rotate(-5deg); opacity: 0; }
  20%  { transform: translate(-50%, -50%) scale(1.3) rotate(2deg); opacity: 1; }
  35%  { transform: translate(-50%, -50%) scale(0.95) rotate(-1deg); opacity: 1; }
  50%  { transform: translate(-50%, -50%) scale(1.05) rotate(0deg); opacity: 1; }
  75%  { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 0.8; }
  100% { transform: translate(-50%, -60%) scale(0.9) rotate(0deg); opacity: 0; }
}

/* =========================================
   Combo Intensity Tiers — escalating glow
   ========================================= */
/* Tier 1: 3x combo — subtle golden glow */
.ytq-dlg-modal.combo-tier-1 {
  box-shadow:
    0 12px 40px rgba(0, 0, 0, 0.7),
    0 0 20px rgba(251, 191, 36, 0.1);
}

/* Tier 2: 5x combo — fire glow + ambient pulse */
.ytq-dlg-modal.combo-tier-2 {
  box-shadow:
    0 12px 40px rgba(0, 0, 0, 0.7),
    0 0 30px rgba(245, 158, 11, 0.2),
    0 0 60px rgba(239, 68, 68, 0.1);
  animation: modal-fire-pulse 1.5s ease-in-out infinite;
}

@keyframes modal-fire-pulse {
  0%, 100% {
    box-shadow:
      0 12px 40px rgba(0, 0, 0, 0.7),
      0 0 30px rgba(245, 158, 11, 0.2),
      0 0 60px rgba(239, 68, 68, 0.1);
  }
  50% {
    box-shadow:
      0 12px 40px rgba(0, 0, 0, 0.7),
      0 0 40px rgba(245, 158, 11, 0.35),
      0 0 80px rgba(239, 68, 68, 0.15);
  }
}

/* Tier 3: 8x combo — inferno, intense pulsing glow */
.ytq-dlg-modal.combo-tier-3 {
  box-shadow:
    0 12px 40px rgba(0, 0, 0, 0.7),
    0 0 40px rgba(239, 68, 68, 0.3),
    0 0 80px rgba(245, 158, 11, 0.2),
    0 0 120px rgba(254, 240, 138, 0.1);
  animation: modal-inferno-pulse 0.8s ease-in-out infinite;
}

@keyframes modal-inferno-pulse {
  0%, 100% {
    box-shadow:
      0 12px 40px rgba(0, 0, 0, 0.7),
      0 0 40px rgba(239, 68, 68, 0.3),
      0 0 80px rgba(245, 158, 11, 0.2),
      0 0 120px rgba(254, 240, 138, 0.1);
  }
  50% {
    box-shadow:
      0 12px 40px rgba(0, 0, 0, 0.7),
      0 0 60px rgba(239, 68, 68, 0.5),
      0 0 100px rgba(245, 158, 11, 0.35),
      0 0 140px rgba(254, 240, 138, 0.15);
  }
}

/* Combo HUD inferno tier (8+) */
.ytq-combo-hud.inferno {
  box-shadow:
    0 0 16px rgba(239, 68, 68, 0.6),
    0 0 32px rgba(245, 158, 11, 0.4),
    0 0 48px rgba(254, 240, 138, 0.2);
  border-color: #ef4444;
  background: linear-gradient(180deg, rgba(239, 68, 68, 0.3) 0%, rgba(245, 158, 11, 0.25) 100%);
  animation: inferno-glow 0.5s ease-in-out infinite;
}

@keyframes inferno-glow {
  0%, 100% {
    box-shadow:
      0 0 16px rgba(239, 68, 68, 0.6),
      0 0 32px rgba(245, 158, 11, 0.4);
    transform: scale(1);
  }
  50% {
    box-shadow:
      0 0 24px rgba(239, 68, 68, 0.8),
      0 0 44px rgba(245, 158, 11, 0.6);
    transform: scale(1.08);
  }
}

/* Fire particles — extra glow at 5+ combo */
.ytq-particle.particle-fire {
  box-shadow: 0 0 8px rgba(255, 100, 0, 0.7), 0 0 4px rgba(255, 255, 255, 0.5);
  border-radius: 50%;
}

/* Responsive */
@media (max-width: 500px) {
  .ytq-dlg-modal {
    width: 96vw;
  }

  .ytq-dlg-portrait {
    width: 24px;
    height: 24px;
  }

  .ytq-dlg-modal .ytq-question-text {
    font-size: clamp(16px, 4.5vw, 20px);
  }

  .ytq-dlg-modal .ytq-option-text {
    font-size: 16px;
  }

  .ytq-hud {
    padding: 8px 12px;
    gap: 8px;
  }

  .ytq-hrt {
    transform: scale(0.75);
  }

  .ytq-hrt-row {
    gap: 4px;
  }

  .ytq-combo-num {
    font-size: 10px;
  }

  .ytq-score-hud {
    font-size: 10px;
  }

  .ytq-torch {
    transform: translateY(-45%) scale(0.7);
  }

  .ytq-torch.left {
    left: 4px;
  }

  .ytq-torch.right {
    right: 1px;
  }

  .ytq-dmg-number {
    font-size: 14px;
  }

  .ytq-dmg-number.dmg-crit {
    font-size: 20px;
  }

  .ytq-combo-announce {
    font-size: 12px;
  }
}

/* =========================================
   Zone Atmosphere — immersive quiz theming
   Each zone adds ambient glow, tinted accents,
   and floating particles to the quiz modal.
   ========================================= */

/* ---- Shared zone particle base ---- */
.ytq-zone-particle {
  position: absolute;
  pointer-events: none;
  z-index: 0;
  opacity: 0;
}

/* =========================================
   MEADOW — Bright green, apple liquid glass
   ========================================= */

.ytq-dlg-modal.zone-meadow {
  position: relative;
  display: flex;
  flex-direction: column;
  background: #0e1e16;
  border-color: transparent;
  border-width: 110px;
  box-shadow: 0 0 0 30px rgba(6, 6, 12, 0.95);
}

.ytq-dlg-modal.zone-meadow > .ytq-content {
  flex: 1;
}

.ytq-dlg-modal.zone-meadow::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  box-shadow:
    inset 0 0 100px rgba(74, 222, 128, 0.12),
    inset 0 -60px 80px rgba(74, 222, 128, 0.08),
    inset 60px 0 60px rgba(74, 222, 128, 0.04),
    inset -60px 0 60px rgba(74, 222, 128, 0.04);
  background:
    radial-gradient(ellipse at 50% 100%, rgba(74, 222, 128, 0.1) 0%, transparent 55%),
    radial-gradient(ellipse at 0% 50%, rgba(74, 222, 128, 0.06) 0%, transparent 45%),
    radial-gradient(ellipse at 100% 50%, rgba(74, 222, 128, 0.06) 0%, transparent 45%),
    radial-gradient(ellipse at 50% 0%, rgba(134, 239, 172, 0.04) 0%, transparent 40%);
}

/* Green-tinted surfaces */
.ytq-dlg-modal.zone-meadow .ytq-question {
  background: linear-gradient(180deg, #0e1e16 0%, #0a1810 100%);
  border-color: #1a3a28;
  box-shadow:
    inset -2px -2px 0 #060e0a,
    inset 2px 2px 0 #1a3a28,
    6px 6px 0 rgba(0, 0, 0, 0.45);
}
.ytq-dlg-modal.zone-meadow .ytq-question-number {
  background: #22c55e;
  border-color: #16a34a;
}
.ytq-dlg-modal.zone-meadow .ytq-option {
  background: #0a1610;
  border-color: #1a3a28;
  border-bottom-color: #0a1a10;
  box-shadow: inset -2px -2px 0 #060e0a, inset 2px 2px 0 #183020;
}
.ytq-dlg-modal.zone-meadow .ytq-option:hover {
  background: #0e2018;
  border-color: #22c55e;
  box-shadow: inset -2px -2px 0 #060e0a, inset 2px 2px 0 #183020, 0 0 16px rgba(74, 222, 128, 0.12);
}
.ytq-dlg-modal.zone-meadow .ytq-option-label {
  background: #0a1610;
  border-color: #1a3a28;
}
.ytq-dlg-modal.zone-meadow .ytq-header {
  background: linear-gradient(180deg, #0e1e16 0%, #0c1a14 100%);
  border-bottom-color: #1a3a28;
}
.ytq-dlg-modal.zone-meadow .ytq-title { color: #4ade80; }
.ytq-dlg-modal.zone-meadow .ytq-textarea {
  background: #081210;
  border-color: #1a3a28;
}

/* Grass blade particles — sway at the bottom */
.zone-p-meadow {
  width: 2px;
  height: 10px;
  background: linear-gradient(to top, #22c55e, #4ade80);
  border-radius: 1px 1px 0 0;
  transform-origin: bottom center;
  animation: meadow-grass-sway 4s ease-in-out infinite;
  opacity: 0.5;
}

/* Stagger blade sizes */
.zone-p-meadow:nth-child(odd) {
  height: 14px;
  opacity: 0.4;
}

.zone-p-meadow:nth-child(3n) {
  height: 8px;
  width: 2px;
  background: linear-gradient(to top, #16a34a, #86efac);
  opacity: 0.35;
}

@keyframes meadow-grass-sway {
  0%, 100% {
    transform: rotate(-6deg) scaleY(1);
    opacity: 0.5;
  }
  25% {
    transform: rotate(4deg) scaleY(1.05);
    opacity: 0.55;
  }
  50% {
    transform: rotate(-3deg) scaleY(0.97);
    opacity: 0.45;
  }
  75% {
    transform: rotate(5deg) scaleY(1.02);
    opacity: 0.5;
  }
}

/* Subtle green tint on the HUD bar */
.ytq-dlg-modal.zone-meadow .ytq-hud {
  background: linear-gradient(180deg, #0a1610 0%, #0c1a14 100%);
  border-bottom-color: rgba(74, 222, 128, 0.15);
}

/* Fill content area so no modal background shows */
.ytq-dlg-modal.zone-meadow .ytq-content {
  background: #0e1e16;
}

/* =========================================
   CAVERNS — Warm amber torchlit stone
   ========================================= */

.ytq-dlg-modal.zone-cave {
  position: relative;
  display: flex;
  flex-direction: column;
  background: #1a1810;
  border-color: transparent;
  border-width: 110px;
}

.ytq-dlg-modal.zone-cave > .ytq-content {
  flex: 1;
}

.ytq-dlg-modal.zone-cave::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  box-shadow:
    inset 0 0 100px rgba(251, 191, 36, 0.1),
    inset 0 -60px 80px rgba(180, 83, 9, 0.06),
    inset 60px 0 60px rgba(251, 191, 36, 0.04),
    inset -60px 0 60px rgba(251, 191, 36, 0.04);
  background:
    radial-gradient(ellipse at 10% 20%, rgba(251, 191, 36, 0.08) 0%, transparent 40%),
    radial-gradient(ellipse at 90% 80%, rgba(251, 191, 36, 0.06) 0%, transparent 40%),
    radial-gradient(ellipse at 50% 50%, rgba(212, 160, 32, 0.03) 0%, transparent 50%);
}

.ytq-dlg-modal.zone-cave .ytq-question {
  background: linear-gradient(180deg, #1a1810 0%, #14120a 100%);
  border-color: #3a3018;
  box-shadow: inset -2px -2px 0 #0a0806, inset 2px 2px 0 #2a2414, 6px 6px 0 rgba(0,0,0,0.45);
}
.ytq-dlg-modal.zone-cave .ytq-question-number {
  background: #d4a020;
  border-color: #8b6914;
}
.ytq-dlg-modal.zone-cave .ytq-option {
  background: #12100a;
  border-color: #3a3018;
  border-bottom-color: #1a1608;
  box-shadow: inset -2px -2px 0 #0a0806, inset 2px 2px 0 #282010;
}
.ytq-dlg-modal.zone-cave .ytq-option:hover {
  background: #1a1810;
  border-color: #d4a020;
  box-shadow: inset -2px -2px 0 #0a0806, inset 2px 2px 0 #282010, 0 0 16px rgba(251, 191, 36, 0.1);
}
.ytq-dlg-modal.zone-cave .ytq-option-label {
  background: #12100a;
  border-color: #3a3018;
}
.ytq-dlg-modal.zone-cave .ytq-header {
  background: linear-gradient(180deg, #1a1810 0%, #181610 100%);
  border-bottom-color: #3a3018;
}
.ytq-dlg-modal.zone-cave .ytq-title { color: #fbbf24; }
.ytq-dlg-modal.zone-cave .ytq-textarea {
  background: #0e0c08;
  border-color: #3a3018;
}

/* Dust motes — tiny floating dots */
.zone-p-cave {
  width: 3px;
  height: 3px;
  background: rgba(251, 191, 36, 0.5);
  border-radius: 50%;
  animation: cave-dust-float 5s ease-in-out infinite;
}

.zone-p-cave:nth-child(odd) {
  width: 2px;
  height: 2px;
  background: rgba(212, 160, 32, 0.4);
}

@keyframes cave-dust-float {
  0% {
    transform: translateY(0) translateX(0);
    opacity: 0;
  }
  15% {
    opacity: 0.5;
  }
  50% {
    transform: translateY(-60px) translateX(10px);
    opacity: 0.4;
  }
  85% {
    opacity: 0.15;
  }
  100% {
    transform: translateY(-120px) translateX(-5px);
    opacity: 0;
  }
}

.ytq-dlg-modal.zone-cave .ytq-hud {
  background: linear-gradient(180deg, #14120a 0%, #181610 100%);
  border-bottom-color: rgba(251, 191, 36, 0.15);
}

.ytq-dlg-modal.zone-cave .ytq-content {
  background: #1a1810;
}

/* =========================================
   DUNGEON — Deep arcane purple, eerie magic
   ========================================= */

.ytq-dlg-modal.zone-dungeon {
  position: relative;
  display: flex;
  flex-direction: column;
  background: #14102a;
  border-color: transparent;
  border-width: 110px;
}

.ytq-dlg-modal.zone-dungeon > .ytq-content {
  flex: 1;
}

.ytq-dlg-modal.zone-dungeon::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  box-shadow:
    inset 0 0 120px rgba(167, 139, 250, 0.1),
    inset 0 0 50px rgba(88, 28, 135, 0.08),
    inset 60px 0 60px rgba(139, 92, 246, 0.04),
    inset -60px 0 60px rgba(139, 92, 246, 0.04);
  background:
    radial-gradient(ellipse at 50% 50%, rgba(167, 139, 250, 0.06) 0%, transparent 50%),
    radial-gradient(ellipse at 20% 80%, rgba(139, 92, 246, 0.05) 0%, transparent 40%),
    radial-gradient(ellipse at 80% 20%, rgba(139, 92, 246, 0.04) 0%, transparent 40%);
}

.ytq-dlg-modal.zone-dungeon .ytq-question {
  background: linear-gradient(180deg, #14102a 0%, #0e0a20 100%);
  border-color: #2a2450;
  box-shadow: inset -2px -2px 0 #06040e, inset 2px 2px 0 #221e40, 6px 6px 0 rgba(0,0,0,0.45);
}
.ytq-dlg-modal.zone-dungeon .ytq-question-number {
  background: #7c3aed;
  border-color: #5b21b6;
  color: #ede9fe;
}
.ytq-dlg-modal.zone-dungeon .ytq-option {
  background: #0c0818;
  border-color: #2a2450;
  border-bottom-color: #140e2a;
  box-shadow: inset -2px -2px 0 #06040e, inset 2px 2px 0 #201a3a;
}
.ytq-dlg-modal.zone-dungeon .ytq-option:hover {
  background: #14102a;
  border-color: #7c3aed;
  box-shadow: inset -2px -2px 0 #06040e, inset 2px 2px 0 #201a3a, 0 0 16px rgba(167, 139, 250, 0.12);
}
.ytq-dlg-modal.zone-dungeon .ytq-option-label {
  background: #0c0818;
  border-color: #2a2450;
}
.ytq-dlg-modal.zone-dungeon .ytq-header {
  background: linear-gradient(180deg, #14102a 0%, #12102a 100%);
  border-bottom-color: #2a2450;
}
.ytq-dlg-modal.zone-dungeon .ytq-title { color: #a78bfa; }
.ytq-dlg-modal.zone-dungeon .ytq-textarea {
  background: #0a0616;
  border-color: #2a2450;
}

/* Magical motes — slow rising purple wisps */
.zone-p-dungeon {
  width: 3px;
  height: 3px;
  background: rgba(167, 139, 250, 0.6);
  border-radius: 50%;
  box-shadow: 0 0 6px rgba(167, 139, 250, 0.4);
  animation: dungeon-wisp-rise 6s ease-in-out infinite;
}

.zone-p-dungeon:nth-child(odd) {
  width: 2px;
  height: 2px;
  background: rgba(139, 92, 246, 0.5);
  box-shadow: 0 0 4px rgba(139, 92, 246, 0.3);
}

@keyframes dungeon-wisp-rise {
  0% {
    transform: translateY(0) translateX(0) scale(0.5);
    opacity: 0;
  }
  20% {
    opacity: 0.6;
    transform: translateY(-20px) translateX(5px) scale(1);
  }
  50% {
    opacity: 0.4;
    transform: translateY(-70px) translateX(-8px) scale(0.9);
  }
  80% {
    opacity: 0.2;
  }
  100% {
    transform: translateY(-140px) translateX(3px) scale(0.4);
    opacity: 0;
  }
}

.ytq-dlg-modal.zone-dungeon .ytq-hud {
  background: linear-gradient(180deg, #0e0a1a 0%, #12102a 100%);
  border-bottom-color: rgba(167, 139, 250, 0.15);
}

.ytq-dlg-modal.zone-dungeon .ytq-content {
  background: #14102a;
}

/* =========================================
   ABYSS — Menacing red, molten inferno
   ========================================= */

.ytq-dlg-modal.zone-abyss {
  position: relative;
  display: flex;
  flex-direction: column;
  background: #1a1010;
  border-color: transparent;
  border-width: 110px;
}

.ytq-dlg-modal.zone-abyss > .ytq-content {
  flex: 1;
}

.ytq-dlg-modal.zone-abyss::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  animation: abyss-quiz-pulse 3s ease-in-out infinite;
  box-shadow:
    inset 0 0 120px rgba(239, 68, 68, 0.12),
    inset 0 0 50px rgba(153, 27, 27, 0.1),
    inset 60px 0 60px rgba(239, 68, 68, 0.04),
    inset -60px 0 60px rgba(239, 68, 68, 0.04);
  background:
    radial-gradient(ellipse at 0% 50%, rgba(239, 68, 68, 0.08) 0%, transparent 40%),
    radial-gradient(ellipse at 100% 50%, rgba(239, 68, 68, 0.08) 0%, transparent 40%),
    radial-gradient(ellipse at 50% 100%, rgba(153, 27, 27, 0.06) 0%, transparent 50%);
}

@keyframes abyss-quiz-pulse {
  0%, 100% {
    box-shadow:
      inset 0 0 120px rgba(239, 68, 68, 0.12),
      inset 0 0 50px rgba(153, 27, 27, 0.1),
      inset 60px 0 60px rgba(239, 68, 68, 0.04),
      inset -60px 0 60px rgba(239, 68, 68, 0.04);
  }
  50% {
    box-shadow:
      inset 0 0 140px rgba(239, 68, 68, 0.18),
      inset 0 0 70px rgba(153, 27, 27, 0.14),
      inset 60px 0 60px rgba(239, 68, 68, 0.06),
      inset -60px 0 60px rgba(239, 68, 68, 0.06);
  }
}

.ytq-dlg-modal.zone-abyss .ytq-question {
  background: linear-gradient(180deg, #1a1010 0%, #140a0a 100%);
  border-color: #3a1818;
  box-shadow: inset -2px -2px 0 #0a0404, inset 2px 2px 0 #2a1414, 6px 6px 0 rgba(0,0,0,0.45);
}
.ytq-dlg-modal.zone-abyss .ytq-question-number {
  background: #dc2626;
  border-color: #991b1b;
  color: #fee2e2;
}
.ytq-dlg-modal.zone-abyss .ytq-option {
  background: #120808;
  border-color: #3a1818;
  border-bottom-color: #1a0a0a;
  box-shadow: inset -2px -2px 0 #0a0404, inset 2px 2px 0 #281010;
}
.ytq-dlg-modal.zone-abyss .ytq-option:hover {
  background: #1a1010;
  border-color: #dc2626;
  box-shadow: inset -2px -2px 0 #0a0404, inset 2px 2px 0 #281010, 0 0 16px rgba(239, 68, 68, 0.12);
}
.ytq-dlg-modal.zone-abyss .ytq-option-label {
  background: #120808;
  border-color: #3a1818;
}
.ytq-dlg-modal.zone-abyss .ytq-header {
  background: linear-gradient(180deg, #1a1010 0%, #181010 100%);
  border-bottom-color: #3a1818;
}
.ytq-dlg-modal.zone-abyss .ytq-title { color: #ef4444; }
.ytq-dlg-modal.zone-abyss .ytq-textarea {
  background: #0e0606;
  border-color: #3a1818;
}

/* Ember particles — rise and glow */
.zone-p-abyss {
  width: 3px;
  height: 3px;
  background: #ef4444;
  border-radius: 50%;
  box-shadow: 0 0 6px rgba(239, 68, 68, 0.6), 0 0 2px rgba(255, 255, 255, 0.3);
  animation: abyss-ember-rise 5s ease-out infinite;
}

.zone-p-abyss:nth-child(odd) {
  width: 2px;
  height: 2px;
  background: #f97316;
  box-shadow: 0 0 4px rgba(249, 115, 22, 0.5);
}

.zone-p-abyss:nth-child(3n) {
  width: 2px;
  height: 2px;
  background: #fbbf24;
  box-shadow: 0 0 4px rgba(251, 191, 36, 0.4);
}

@keyframes abyss-ember-rise {
  0% {
    transform: translateY(0) translateX(0) scale(1);
    opacity: 0;
  }
  10% {
    opacity: 0.8;
  }
  30% {
    transform: translateY(-40px) translateX(8px) scale(0.9);
    opacity: 0.7;
  }
  60% {
    transform: translateY(-100px) translateX(-5px) scale(0.6);
    opacity: 0.4;
  }
  100% {
    transform: translateY(-180px) translateX(3px) scale(0.2);
    opacity: 0;
  }
}

.ytq-dlg-modal.zone-abyss .ytq-hud {
  background: linear-gradient(180deg, #140a0a 0%, #1a1010 100%);
  border-bottom-color: rgba(239, 68, 68, 0.2);
}

.ytq-dlg-modal.zone-abyss .ytq-content {
  background: #1a1010;
}

/* ---- Ensure quiz content sits above zone atmosphere ---- */
.ytq-dlg-modal .ytq-header,
.ytq-dlg-modal .ytq-hud,
.ytq-dlg-modal .ytq-content {
  position: relative;
  z-index: 1;
}
